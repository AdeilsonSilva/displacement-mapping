<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Displacement Mapping</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section data-autoslide="1" id="dummy">
                    <!--
                        Não é pra ter nada aqui, essa section só existe porque
                        o reveal.js não lida muito bem com vídeos no primeiro slide. LoL
                    -->
                </section>
                <!-- Introdução -->
                <section id="intro">
                    <section data-background-video="images/intro.ogv" data-background-video-loop="loop">
                        <h1 style="color:#FFF;">Displacement Mapping</h1>
                        <h3 style="color:#FFF;">Universidade Federal da Bahia</h3>
                        <p style="color:#FFF;">
                            <small>MATA65 - Computação Gráfica / 2017.1</small>
                        </p>
                        <p style="color:#FFF;">
                            <small> Adeilson Silva / <a href="https://github.com/AdeilsonSilva">@adeilsonsilva</a> &</small>
                            <small> Rafael Brasileiro / <a href="https://github.com/rafaelbps89">@rafaelbps89</a></small>
                        </p>
                        <aside class="notes">
                            Boa tarde!
                            meu nome é X
                            hoje vamos apresentar sobre jkhdkasd
                        </aside>
                    </section>
                </section>
                <!-- Aspectos Teóricos -->
				<section id="teoria">
                    <section data-background-video="images/teoria.ogv" data-background-video-loop="loop">
                        <h1 style="color:black">Aspectos Teóricos</h1>
                        <aside class="notes">
                            Vamos começar apresentando um pouco da teoria por trás do DM.
                        </aside>
                    </section>
                    <!-- Conceito de Displacement Mapping -->
                    <section>
                        <h3>Mas o que é displacement mapping?</h3>
                        <aside class="notes">
                            Então, afinal de contas, o que é DM?
                        </aside>
					</section>
                    <section data-background-video="images/exp-dm.ogv">
                        <p>Szirmay-Kalos <i>et. al.</i></p>
                        <blockquote cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
    						&ldquo;
                                Displacement mapping provides high frequency geometric detail by adding mesostructure properties to the macrostructure model.
                                This is done by modulating the smooth macrostructure surface by a height map describing the difference between the macrostructure
                                and the mesostructure models. [1]
                            &rdquo;
    					</blockquote>
                        <aside class="notes">
                            * fazer referência ao vídeo do fundo *
                        </aside>
                    </section>
                    <!-- Motivação e Objetivo do artigo -->
                    <section>
                        <h2>Mas por que falar de displacement mapping?</h2>
					</section>
                    <section>
                        <p>A motivação para o uso de displacement mapping é reproduzir uma estrutura de maneira detalhada
                        reduzindo o número de vértices utilizados.</p>
					</section>
                    <section>
                        <p>
                            Szirmay‐Kalos [1] faz uma revisão sobre as principais técnicas de DP disponíveis na literatura,
                            comparando as técnicas utilizadas e os resultados obtidos pelos autores, apresentando o estado da
                            arte da época.
                        </p>
					</section>
                    <!-- Teoria de Displacement Mapping -->
                    <section>
                        <h2>O que mais eu preciso saber?</h2>
					</section>
                    <section>
                        <section>
                            <img width="1056" height="368" data-src="images/intro.png" alt="introdução">
                        </section>
                        <ul>
                            <li>Macroestrutura</li>
                            <li>Mesoestrutura</li>
                            <li>Microestrutura</li>
                        </ul>
					</section>
                    <section>
                        <h3>Para utilizar displacement mapping eu preciso:</h3>
                        <ul>
                            <li>.obj</li>
                            <li>mapa de altura</li>
                        </ul>
					</section>
                    <section>
                        <img width="1324" height="208" data-src="images/f1.png">
                        <p>Fórmula utilizada para o cálculo da mesoestrutura.</p>
                    </section>
                    <section>
                        <h3>Você conhece a fórmula parametrizada da sua geometria?</h3>
                    </section>
                    <section>
                        <h3>E caso você não conheça?</h3>
                    </section>
                    <section>
                        <h3>O mapa de altura é armazenado de forma compactada.</h3>
                    </section>
                    <section>
                        <img width="780" height="126" data-src="images/f3.png">
                        <p>Transformação dos valores do mapa de altura para o espaço de valores real.</p>
                    </section>
                    <section>
                        <h3>E a iluminação? Como eu calculo?</h3>
                    </section>
                    <section>
                        <h2>Cálculo da normal da mesosestrutura:</h2>
                        <pre><code class="hljs" data-trim>
                            float2 du=float2(1/WIDTH, 0);
                            float2 dv=float2(0, 1/HEIGHT);
                            float dhdu = SCALE/(2/WIDTH) * (tex2D(hMap, uv+du).a - tex2D(hMap, uv-du).a);
                            float dhdv = SCALE/(2/HEIGHT) * (tex2D(hMap, uv+dv).a - tex2D(hMap, uv-dv).a);
                            // get model space normal vector
                            float3 mNormal = normalize(N+t*dhdu+b*dhdv);
    					</code></pre>
                    </section>
                    <section>
                        <h3>Displacement Mapping no Vertex Shader</h3>
					</section>
                    <section>
                        <h3>Displacement Mapping no Fragment Shader</h3>
					</section>
                </section>
                <!-- Aspectos Práticos -->
                <section id="pratica">
                    <section data-background-video="images/pratica.ogv" data-background-video-loop="loop">
                        <h1>Aspectos Práticos</h1>
                    </section>
                    <section data-background="images/envmap.png" data-background-repeat="repeat" data-background-size="250px">
    					<h2>Carregando texturas (Mapa de ambiente)</h2>
    					<pre><code class="hljs" data-trim contenteditable>
                            // env map

                            var path = "textures/cube/SwedishRoyalCastle/";
                            var format = '.jpg';
                            var urls = [
                                path + 'px' + format, path + 'nx' + format,
                                path + 'py' + format, path + 'ny' + format,
                                path + 'pz' + format, path + 'nz' + format
                            ];

                            var reflectionCube = new THREE.CubeTextureLoader().load( urls );
    					</code></pre>
    				</section>
                    <section data-background="images/texturas.png" data-background-repeat="repeat" data-background-size="400px">
    					<h2>Carregando texturas</h2>
    					<pre><code class="hljs" data-trim contenteditable>
                            // textures

                            var textureLoader = new THREE.TextureLoader();
                            var normalMap = textureLoader.load("models/obj/ninja/normal.jpg");
                            var aoMap = textureLoader.load("models/obj/ninja/ao.jpg");
                            var displacementMap = textureLoader.load("models/obj/ninja/displacement.jpg");
    					</code></pre>
    				</section>
                    <section>
    					<h2>Inicializando materiais</h2>
    					<pre><code class="hljs" data-trim contenteditable>
                            // material

                            material = new THREE.MeshStandardMaterial( {

                                color: 0x888888,
                                roughness: settings.roughness,
                                metalness: settings.metalness,

                                normalMap: normalMap,
                                normalScale: new THREE.Vector2( 1, - 1 ),

                                aoMap: aoMap,
                                aoMapIntensity: 1,

                                displacementMap: displacementMap,
                                displacementScale: settings.displacementScale,
                                displacementBias: - 0.428408, // from original model

                                envMap: reflectionCube,
                                envMapIntensity: settings.envMapIntensity,

                                side: THREE.DoubleSide

                            } );
    					</code></pre>
    				</section>
                    <section>
    					<h2>Carregando objeto com a geometria</h2>
    					<pre><code class="hljs" data-trim contenteditable>
                            // geometry

                            var loader = new THREE.OBJLoader();
                            loader.load(
                                "models/obj/ninja/ninjaHead_Low.obj",
                                function ( group ) {
                                    var geometry = group.children[ 0 ].geometry;
                                    geometry.attributes.uv2 = geometry.attributes.uv;
                                    geometry.center();

                                    mesh = new THREE.Mesh( geometry, material );
                                    mesh.scale.multiplyScalar( 25 );
                                    scene.add( mesh );


                                }
                            );
    					</code></pre>
    				</section>
                </section>
                <!-- Referências -->
                <section>
                    <h1>Referências</h1>
					<ol>
						<li>
                            <a href="https://pdfs.semanticscholar.org/4ec1/914e7d2319be9bc6da58dd57e5aa16be6c9c.pdf">
                                Szirmay‐Kalos, L., & Umenhoffer, T. (2008, September). Displacement Mapping on the GPU
                            </a>
                        </li>
						<li>
                            <a href="https://threejs.org/examples/webgl_materials_displacementmap.html">
                                three.js - (normal + ao + displacement + environment) map demo
                            </a>
                        </li>
					</ol>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
                // Display controls in the bottom right corner
            	controls: true,
                // Display a presentation progress bar
            	progress: true,
            	// Set default timing of 2 minutes per slide
            	defaultTiming: 120,
            	// Display the page number of the current slide
            	slideNumber: false,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
